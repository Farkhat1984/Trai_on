# üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º —Å API Gemini

## –¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:
```
–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: DioExceptionType.badResponse
```

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ **—Å–µ—Ä–≤–µ—Ä Google –ø–æ–ª—É—á–∏–ª –∑–∞–ø—Ä–æ—Å**, –Ω–æ **–≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É**.

---

## üÜï –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è:

### 1. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–ø—Ä–æ—Å–µ:
```
=== –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ ===
URL: https://generativelanguage.googleapis.com/...
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: 1 + 1
–¢–µ–∫—Å—Ç –ø—Ä–æ–º–ø—Ç–∞: Using the provided image of a person...
responseModalities: [IMAGE]
aspectRatio: 1:1
=======================
```

### 2. –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–µ:
```
=== DioException –¥–µ—Ç–∞–ª–∏ ===
–¢–∏–ø: DioExceptionType.badResponse
–°—Ç–∞—Ç—É—Å –∫–æ–¥: 400
–°–æ–æ–±—â–µ–Ω–∏–µ: ...
–û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:
{
  "error": {
    "code": 400,
    "message": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ –æ—Ç Google",
    "status": "INVALID_ARGUMENT"
  }
}
========================
```

---

## üî¥ –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ Google API:

### 1. **–û—à–∏–±–∫–∞ 400 (Bad Request)**
```json
{
  "error": {
    "code": 400,
    "message": "Invalid request"
  }
}
```

**–ü—Ä–∏—á–∏–Ω—ã:**
- ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–∞
- ‚ùå –ù–µ–≤–µ—Ä–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
- ‚ùå –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- ‚ùå –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π `imageConfig`

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É `payload`
- –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ `imageConfig` –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏

---

### 2. **–û—à–∏–±–∫–∞ 403 (Forbidden)**
```json
{
  "error": {
    "code": 403,
    "message": "API key not valid"
  }
}
```

**–ü—Ä–∏—á–∏–Ω—ã:**
- ‚ùå –ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π API –∫–ª—é—á
- ‚ùå API –∫–ª—é—á –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
- ‚ùå –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –º–æ–¥–µ–ª–∏

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API –∫–ª—é—á: https://aistudio.google.com/app/apikey
2. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ Gemini API –≤–∫–ª—é—á–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–≤–æ—Ç—ã

---

### 3. **–û—à–∏–±–∫–∞ 404 (Not Found)**
```json
{
  "error": {
    "code": 404,
    "message": "Model not found"
  }
}
```

**–ü—Ä–∏—á–∏–Ω—ã:**
- ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
- ‚ùå –ú–æ–¥–µ–ª—å –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- ‚ùå –û–ø–µ—á–∞—Ç–∫–∞ –≤ URL

**–¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å:**
```
gemini-2.5-flash-image-preview
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å URL:**
```
https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-image-preview:generateContent
```

---

### 4. **–û—à–∏–±–∫–∞ 429 (Too Many Requests)**
```json
{
  "error": {
    "code": 429,
    "message": "Quota exceeded"
  }
}
```

**–ü—Ä–∏—á–∏–Ω—ã:**
- ‚ùå –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ (15/–º–∏–Ω—É—Ç—É)
- ‚ùå –ü—Ä–µ–≤—ã—à–µ–Ω–∞ –¥–Ω–µ–≤–Ω–∞—è –∫–≤–æ—Ç–∞

**–†–µ—à–µ–Ω–∏–µ:**
- –ü–æ–¥–æ–∂–¥–∞—Ç—å 1-2 –º–∏–Ω—É—Ç—ã
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–≤–æ—Ç—ã –≤ –∫–æ–Ω—Å–æ–ª–∏ Google Cloud

---

### 5. **–û—à–∏–±–∫–∞ 500+ (Server Error)**
```json
{
  "error": {
    "code": 500,
    "message": "Internal server error"
  }
}
```

**–ü—Ä–∏—á–∏–Ω—ã:**
- ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ Google
- ‚ùå –í—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–∞

**–†–µ—à–µ–Ω–∏–µ:**
- –ü–æ–¥–æ–∂–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç
- –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É

---

## üöÄ –ö–∞–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É:

### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```powershell
flutter run
```

### –®–∞–≥ 2: –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä–∏—Ç—å –æ–¥–µ–∂–¥—É

### –®–∞–≥ 3: –°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏

–í—ã —É–≤–∏–¥–∏—Ç–µ:
```
=== –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ ===
...
=== DioException –¥–µ—Ç–∞–ª–∏ ===
–¢–∏–ø: badResponse
–°—Ç–∞—Ç—É—Å –∫–æ–¥: 400
–û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:
{
  "error": {
    "code": 400,
    "message": "..." ‚Üê –í–û–¢ –ü–†–ò–ß–ò–ù–ê!
  }
}
```

### –®–∞–≥ 4: –ù–∞–π–¥–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –ø–æ –∫–æ–¥—É –æ—à–∏–±–∫–∏

---

## üîß –ß–∞—Å—Ç—ã–µ —Ä–µ—à–µ–Ω–∏—è:

### –ü—Ä–æ–±–ª–µ–º–∞: `imageConfig` –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç—Å—è
**–û—à–∏–±–∫–∞:**
```
"message": "Unknown field 'imageConfig' in generationConfig"
```

**–†–µ—à–µ–Ω–∏–µ:**
–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `imageConfig` –Ω–∞ **–≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ**:
```dart
final payload = {
  'contents': [...],
  'generationConfig': {...},
  'imageConfig': {...},  // ‚Üê –ó–¥–µ—Å—å!
};
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
**–û—à–∏–±–∫–∞:**
```
"message": "Model gemini-2.5-flash-image-preview not found"
```

**–†–µ—à–µ–Ω–∏–µ:**
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –≤ `_baseUrl`:
```dart
static const String _baseUrl =
    'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-image-preview:generateContent';
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: API –∫–ª—é—á –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω
**–û—à–∏–±–∫–∞:**
```
"message": "API key not valid"
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://aistudio.google.com/app/apikey
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–ª—é—á
3. –ó–∞–º–µ–Ω–∏—Ç–µ –≤ `api_service.dart`:
```dart
static const String _apiKey = '–í–ê–®_–ù–û–í–´–ô_–ö–õ–Æ–ß';
```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç
**–û—à–∏–±–∫–∞:**
```
"message": "Quota exceeded"
```

**–†–µ—à–µ–Ω–∏–µ:**
–ü–æ–¥–æ–∂–¥–∏—Ç–µ 1-2 –º–∏–Ω—É—Ç—ã. –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ª–∏–º–∏—Ç:
- **15 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É**
- **1500 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å**

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:

```dart
{
  "contents": [
    {
      "parts": [
        {"inlineData": {"mimeType": "image/png", "data": "..."}},
        {"inlineData": {"mimeType": "image/png", "data": "..."}},
        {"text": "..."}
      ]
    }
  ],
  "systemInstruction": {
    "parts": [{"text": "..."}]
  },
  "generationConfig": {
    "temperature": 0.4,
    "topK": 32,
    "topP": 1,
    "maxOutputTokens": 8192,
    "responseModalities": ["IMAGE"]
  },
  "imageConfig": {              // ‚Üê –ù–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ!
    "aspectRatio": "1:1"
  }
}
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API –∫–ª—é—á–∞:

### –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
```bash
curl -X POST \
  'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-image-preview:generateContent?key=–í–ê–®_–ö–õ–Æ–ß' \
  -H 'Content-Type: application/json' \
  -d '{
    "contents": [
      {
        "parts": [
          {"text": "Generate a simple red circle"}
        ]
      }
    ],
    "generationConfig": {
      "responseModalities": ["IMAGE"]
    },
    "imageConfig": {
      "aspectRatio": "1:1"
    }
  }'
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "candidates": [
    {
      "content": {
        "parts": [
          {
            "inlineData": {
              "mimeType": "image/png",
              "data": "base64..."
            }
          }
        ]
      },
      "finishReason": "STOP"
    }
  ]
}
```

---

## üìù –ß–µ–∫-–ª–∏—Å—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

- [ ] –°–º–æ—Ç—Ä—é –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
- [ ] –í–∏–∂—É –∫–æ–¥ –æ—à–∏–±–∫–∏ (400, 403, 404, 429, 500)
- [ ] –ß–∏—Ç–∞—é —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
- [ ] –ü—Ä–æ–≤–µ—Ä—è—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∑–∞–ø—Ä–æ—Å–∞
- [ ] –ü—Ä–æ–≤–µ—Ä—è—é API –∫–ª—é—á
- [ ] –ü—Ä–æ–≤–µ—Ä—è—é –∫–≤–æ—Ç—ã
- [ ] –ü—Ä–æ–≤–µ—Ä—è—é –Ω–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
- [ ] –ü—Ä–æ–±—É—é –ø—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –ª–æ–≥–∞–º–∏:
```powershell
flutter run
```

### 2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª–Ω—ã–π –≤—ã–≤–æ–¥:
```
=== –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ ===
...
=== DioException –¥–µ—Ç–∞–ª–∏ ===
...
–û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:
...
```

### 3. –ù–∞–π–¥–∏—Ç–µ –∫–æ–¥ –æ—à–∏–±–∫–∏ –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ

### 4. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ —Ä–µ—à–µ–Ω–∏–µ –∏–∑ —ç—Ç–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞

---

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:

- **API Studio:** https://aistudio.google.com/app/apikey
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** https://ai.google.dev/gemini-api/docs
- **–ö–≤–æ—Ç—ã:** https://console.cloud.google.com/
- **–°—Ç–∞—Ç—É—Å—ã –∫–æ–¥–æ–≤:** https://developer.mozilla.org/en-US/docs/Web/HTTP/Status

---

**–í–ê–ñ–ù–û:** –°–º–æ—Ç—Ä–∏—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ - –æ–Ω–∏ –ø–æ–∫–∞–∂—É—Ç —Ç–æ—á–Ω—É—é –ø—Ä–∏—á–∏–Ω—É! üëÄ
